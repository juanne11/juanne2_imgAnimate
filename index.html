<!DOCTYPE html>
<html>
  <head>
    <title>Marker-Based AR - Natural Walking Fox</title>
    <meta name="description" content="A-Frame AR.js Fox with natural walking motion" />
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  </head>
  <body>
    <div style="
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;">
      <button id="animate-button" style="padding: 12px 24px; font-size: 16px; cursor: pointer;">
        Start Walking Fox
      </button>
    </div>

    <a-scene embedded arjs>
      <a-assets>
        <a-asset-item id="Fox" src="./Fox.glb"></a-asset-item>
      </a-assets>

      <a-marker preset="hiro">
        <!-- Parent for smooth rotation -->
        <a-entity id="rotator-parent" position="0 0 -90"
          animation__rotate="property: rotation;
            from: 0 0 0;
            to: 0 360 0;
            loop: true;
            dur: 15000;
            easing: linear;
            startEvents: start-rotation;">

          <!-- Fox model -->
          <a-gltf-model
            id="fox"
            src="#Fox"
            position="0 0.2 0"
            scale="0.3 0.3 0.3"
            rotation="0 0 0"

            <!-- breathing / body bounce -->
            animation__breathe="
              property: position;
              dir: alternate;
              dur: 1000;
              easing: easeInOutSine;
              loop: true;
              to: 0 0.28 0;
              startEvents: start-walk;"

            <!-- head tilt -->
            animation__head="
              property: rotation;
              dir: alternate;
              dur: 1600;
              easing: easeInOutSine;
              loop: true;
              to: -88 10 0;
              startEvents: start-walk;"

            <!-- small body sway (as walking) -->
            animation__sway="
              property: rotation;
              dir: alternate;
              dur: 900;
              easing: easeInOutQuad;
              loop: true;
              to: -90 0 5;
              startEvents: start-walk;"

            <!-- simulate step movement -->
            animation__step="
              property: position;
              dir: alternate;
              dur: 800;
              easing: easeInOutSine;
              loop: true;
              to: 0.05 0.2 -0.05;
              startEvents: start-walk;"
          >
          </a-gltf-model>

        </a-entity>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const button = document.getElementById('animate-button');
        const rotatorParent = document.getElementById('rotator-parent');
        const fox = document.getElementById('fox');

        button.addEventListener('click', () => {
          rotatorParent.emit('start-rotation');
          fox.emit('start-walk');
        });

        // ðŸ¦Š Tambahkan animasi ekor setelah model dimuat
        fox.addEventListener('model-loaded', () => {
          const tail = fox.getObject3D('mesh').getObjectByName('Tail') ||
                       fox.getObject3D('mesh').getObjectByName('tail') ||
                       fox.getObject3D('mesh').getObjectByName('Bone_tail');

          if (tail) {
            // Buat animasi ekor bergoyang kanan kiri
            fox.sceneEl.object3D.addEventListener('tick', () => {
              const time = Date.now() * 0.0025;
              tail.rotation.y = Math.sin(time) * 0.5;
              tail.rotation.x = Math.cos(time) * 0.1;
            });
            console.log('Tail animation added');
          } else {
            console.warn('Tail not found in model');
          }
        });
      });
    </script>
  </body>
</html>










